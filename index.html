<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>متجر المعرفة للمنتجات الرقمية</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    <!-- Swiper's CSS -->
    <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css"/>
    <style>
        body {
            font-family: 'Cairo', sans-serif;
            background-color: #0c1427;
            color: #e0e0e0;
        }
        .hero-bg {
            background-image: linear-gradient(rgba(12, 20, 39, 0.8), rgba(12, 20, 39, 1)), url('https://placehold.co/1200x600/0a192f/e0e0e0?text=اكتشف+عالم+المعرفة');
            background-size: cover;
            background-position: center;
        }
        .card {
            background-color: #1a2942;
            transition: transform 0.3s, box-shadow 0.3s;
        }
        .card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 25px -5px rgba(251, 191, 36, 0.1), 0 10px 10px -5px rgba(251, 191, 36, 0.04);
        }
        .btn-primary {
            background-color: #fbbf24;
            color: #1a2942;
            transition: background-color 0.3s;
        }
        .btn-primary:hover {
            background-color: #f59e0b;
        }
        .btn-secondary {
             background-color: transparent;
             color: #fbbf24;
             border: 1px solid #fbbf24;
             transition: background-color 0.3s, color 0.3s;
        }
        .btn-secondary:hover {
            background-color: #fbbf24;
            color: #1a2942;
        }
        .page-content {
            display: none; /* Hide all pages by default */
        }
        #home.page-content {
            display: block; /* Show home page by default */
        }
        .nav-link.active {
            color: #fbbf24;
            font-weight: bold;
        }
        .swiper-container {
            width: 100%;
            height: 50vh;
            max-height: 450px;
            border-radius: 1rem;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        .swiper-slide img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        /* Cart & Checkout Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.6);
            backdrop-filter: blur(5px);
        }
        .modal-content {
            background-color: #1a2942;
            margin: 10% auto;
            padding: 2rem;
            border-radius: 1rem;
            width: 90%;
            max-width: 600px;
            color: #e0e0e0;
        }
        .cart-item img {
            width: 60px;
            height: 60px;
            object-fit: cover;
            border-radius: 0.5rem;
        }
    </style>
</head>
<body>

    <!-- Header -->
    <header class="bg-gray-900/50 backdrop-blur-sm sticky top-0 z-50">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
            <h1 class="text-xl md:text-2xl font-bold text-white flex items-center">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 ml-3 text-amber-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
                </svg>
                <div>
                    <span class="text-amber-400">متجر</span> المعرفة
                    <span class="block text-sm font-normal text-gray-400 md:inline">للمنتجات الرقمية</span>
                </div>
            </h1>
            <nav id="main-nav" class="hidden md:flex space-x-8 space-x-reverse text-lg">
                <a href="#" onclick="showPage('home', this)" class="nav-link active hover:text-amber-400 transition-colors">الرئيسية</a>
                <a href="#" onclick="showPage('products', this)" class="nav-link hover:text-amber-400 transition-colors">المنتجات</a>
                <a href="#" onclick="showPage('about', this)" class="nav-link hover:text-amber-400 transition-colors">حولنا</a>
                <a href="#" onclick="showPage('contact', this)" class="nav-link hover:text-amber-400 transition-colors">اتصل بنا</a>
            </nav>
            <div class="flex items-center">
                <button id="cart-button" class="ml-4 relative">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-white hover:text-amber-400 transition-colors" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z" />
                    </svg>
                    <span id="cart-counter" class="absolute -top-2 -right-2 bg-red-600 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center">0</span>
                </button>
                 <button class="md:hidden">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7" />
                    </svg>
                </button>
            </div>
        </div>
    </header>

    <main>
        <!-- Home Page Wrapper -->
        <div id="home" class="page-content">
            <section class="hero-bg text-white">
                <div class="container mx-auto px-6 py-24 md:py-32 text-center">
                    <h2 class="text-4xl md:text-6xl font-bold mb-4 leading-tight">بوابتك إلى عالم من الإلهام</h2>
                    <p class="text-xl md:text-2xl mb-8 max-w-3xl mx-auto">منتجات فريدة تشعل فضولك وتضيء أفكارك.</p>
                    <a href="#" onclick="showPage('products', document.querySelector('a[onclick*=\'products\']'))" class="btn-primary font-bold py-3 px-8 rounded-lg text-lg">تصفح المنتجات</a>
                </div>
            </section>
            <section class="py-16 bg-0c1427">
                <div class="container mx-auto px-6">
                    <h3 class="text-3xl font-bold text-center mb-10 text-amber-400">نافذة على عالم المعرفة</h3>
                    <div class="swiper-container">
                        <div class="swiper-wrapper">
                            <div class="swiper-slide"><img src="https://images.pexels.com/photos/3184418/pexels-photo-3184418.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1" alt="فريق عمل يناقش أفكاراً"></div>
                            <div class="swiper-slide"><img src="https://images.pexels.com/photos/4145190/pexels-photo-4145190.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1" alt="سيدة تعمل على لابتوب في مكان هادئ"></div>
                            <div class="swiper-slide"><img src="https://images.pexels.com/photos/159711/books-bookstore-book-reading-159711.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1" alt="ممر في مكتبة عامرة بالكتب"></div>
                            <div class="swiper-slide"><img src="https://images.pexels.com/photos/590022/pexels-photo-590022.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1" alt="مكتب عمل مع لابتوب ورسوم بيانية"></div>
                            <div class="swiper-slide"><img src="https://images.pexels.com/photos/380769/pexels-photo-380769.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1" alt="مكتب عصري وأنيق"></div>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- Products Section -->
        <section id="products" class="py-20 page-content">
            <div class="container mx-auto px-6">
                <h3 class="text-4xl font-bold text-center mb-12">منتجاتنا المميزة</h3>
                <div id="products-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-10">
                    <p class="col-span-full text-center text-lg">جاري تحميل المنتجات...</p>
                </div>
                <div class="text-center mt-16">
                    <button onclick="showPage('home', document.querySelector('a[onclick*=\'home\']'))" class="btn-secondary font-bold py-3 px-8 rounded-lg text-lg">
                        العودة للصفحة الرئيسية
                    </button>
                </div>
            </div>
        </section>

        <!-- About Us Section -->
        <section id="about" class="py-20 bg-gray-900/30 page-content">
            <div class="container mx-auto px-6 text-center">
                <h3 class="text-4xl font-bold mb-6">عن متجر المعرفة للمنتجات الرقمية</h3>
                <p class="text-xl max-w-4xl mx-auto leading-relaxed">
                    نؤمن في "متجر المعرفة" بأن الفضول هو شرارة الإبداع. كل منتج في متجرنا مصمم ليكون أكثر من مجرد غرض، بل هو أداة لإثارة التساؤل، وتشجيع التعلم، والاحتفاء برحلة الاكتشاف الفكري. من الفن الذي يجسد الحكمة إلى الأدوات التي تنظم أفكارك، نحن هنا لنرافقك في مسيرتك نحو الارتقاء.
                </p>
                <div class="text-center mt-12">
                    <button onclick="showPage('home', document.querySelector('a[onclick*=\'home\']'))" class="btn-secondary font-bold py-3 px-8 rounded-lg text-lg">
                        العودة للصفحة الرئيسية
                    </button>
                </div>
            </div>
        </section>

        <!-- Contact Us Section -->
        <section id="contact" class="py-20 page-content">
            <div class="container mx-auto px-6">
                <h3 class="text-4xl font-bold text-center mb-12">تواصل معنا</h3>
                <p class="text-center text-lg text-gray-400 max-w-2xl mx-auto mb-12">
                    نسعد باستقبال استفساراتكم ومقترحاتكم. يمكنكم التواصل معنا عبر القنوات التالية:
                </p>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8 max-w-5xl mx-auto">
                    <a href="https://wa.me/966560223241" target="_blank" class="contact-card p-8 rounded-lg text-center flex flex-col items-center">
                        <svg class="w-16 h-16 text-green-400 mb-4" fill="currentColor" viewBox="0 0 24 24"><path d="M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.245 2.248 3.481 5.236 3.48 8.414-.003 6.557-5.338 11.892-11.893 11.892-1.99-.001-3.951-.5-5.688-1.448l-6.305 1.654zm6.597-3.807c1.676.995 3.276 1.591 5.392 1.592 5.448 0 9.886-4.434 9.889-9.885.002-5.462-4.415-9.89-9.881-9.892-5.452 0-9.887 4.434-9.889 9.884-.001 2.225.651 4.315 1.847 6.062l-1.011 3.697 3.82-1.004zm11.387-5.464c-.074-.124-.272-.198-.57-.347-.297-.149-1.758-.868-2.031-.967-.272-.099-.47-.149-.669.149-.198.297-.768.967-.941 1.165-.173.198-.347.223-.644.074-.297-.149-1.255-.462-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.297-.347.446-.521.151-.172.2-.296.3-.495.099-.198.05-.372-.025-.521-.075-.148-.669-1.611-.916-2.206-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01s-.521.074-.792.372c-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.626.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.695.248-1.29.173-1.414z"/></svg>
                        <h4 class="text-2xl font-bold mt-2">واتساب</h4>
                        <p class="text-lg text-amber-400 mt-1" dir="ltr">+966 56 022 3241</p>
                    </a>
                    <a href="tel:+966502311308" class="contact-card p-8 rounded-lg text-center flex flex-col items-center">
                        <svg class="w-16 h-16 text-sky-400 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path></svg>
                        <h4 class="text-2xl font-bold mt-2">اتصال</h4>
                        <p class="text-lg text-amber-400 mt-1" dir="ltr">+966 50 231 1308</p>
                    </a>
                    <a href="mailto:maarifastore@gmail.com" class="contact-card p-8 rounded-lg text-center flex flex-col items-center">
                        <svg class="w-16 h-16 text-red-400 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path></svg>
                        <h4 class="text-2xl font-bold mt-2">البريد الإلكتروني</h4>
                        <p class="text-lg text-amber-400 mt-1 break-all">maarifastore@gmail.com</p>
                    </a>
                </div>
                <div class="text-center mt-16">
                    <button onclick="showPage('home', document.querySelector('a[onclick*=\'home\']'))" class="btn-secondary font-bold py-3 px-8 rounded-lg text-lg">
                        العودة للصفحة الرئيسية
                    </button>
                </div>
            </div>
        </section>
        
        <!-- Checkout Page -->
        <section id="checkout" class="py-20 page-content">
            <div class="container mx-auto px-6">
                <h3 class="text-4xl font-bold text-center mb-12">إتمام عملية الشراء</h3>
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-12">
                    <!-- Customer Info Form -->
                    <div class="lg:col-span-2 bg-gray-900/30 p-8 rounded-lg">
                        <h4 class="text-2xl font-bold mb-6">معلومات العميل</h4>
                        <form id="checkout-form">
                            <div class="mb-4">
                                <label for="customer-name" class="block mb-2">الاسم الكامل</label>
                                <input type="text" id="customer-name" class="w-full p-2 rounded bg-gray-800 border border-gray-700 focus:outline-none focus:ring-2 focus:ring-amber-400" required>
                            </div>
                            <div class="mb-4">
                                <label for="customer-phone" class="block mb-2">رقم الجوال</label>
                                <input type="tel" id="customer-phone" class="w-full p-2 rounded bg-gray-800 border border-gray-700 focus:outline-none focus:ring-2 focus:ring-amber-400" required>
                            </div>
                            <h4 class="text-2xl font-bold mt-8 mb-6">طرق الدفع</h4>
                             <div class="bg-gray-800 p-4 rounded-lg">
                                <p class="text-center text-gray-400 mb-4">اختر طريقة الدفع المفضلة لديك</p>
                                <div class="flex justify-center items-center space-x-4 space-x-reverse">
                                    <img src="https://upload.wikimedia.org/wikipedia/commons/f/f2/Mada_logo.svg" alt="Mada" class="h-8 bg-white p-1 rounded">
                                    <img src="https://upload.wikimedia.org/wikipedia/commons/5/5e/Visa_Inc._logo.svg" alt="Visa" class="h-8">
                                    <img src="https://upload.wikimedia.org/wikipedia/commons/a/a4/Mastercard_2019_logo.svg" alt="Mastercard" class="h-8">
                                    <img src="https://upload.wikimedia.org/wikipedia/commons/f/fa/Apple_Pay_logo.svg" alt="Apple Pay" class="h-10">
                                </div>
                            </div>
                        </form>
                    </div>
                    <!-- Order Summary -->
                    <div class="bg-gray-900/30 p-8 rounded-lg">
                        <h4 class="text-2xl font-bold mb-6">ملخص الطلب</h4>
                        <div id="checkout-summary" class="space-y-3 mb-6">
                            <!-- Checkout summary items will be injected here -->
                        </div>
                        <div class="border-t border-gray-700 pt-4 space-y-2">
                            <div class="flex justify-between">
                                <span>المجموع الفرعي</span>
                                <span id="checkout-subtotal">0 ر.س</span>
                            </div>
                            <div class="flex justify-between font-bold text-xl">
                                <span>الإجمالي</span>
                                <span id="checkout-total">0 ر.س</span>
                            </div>
                        </div>
                        <button type="submit" form="checkout-form" class="w-full btn-primary font-bold py-3 px-8 rounded-lg text-lg mt-6">تأكيد الطلب</button>
                        <button onclick="showPage('products', document.querySelector('a[onclick*=\'products\']'))" class="w-full text-center mt-4 text-gray-400 hover:text-white">
                            العودة للمنتجات
                        </button>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <!-- Cart Modal -->
    <div id="cart-modal" class="modal">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-3xl font-bold">سلة المشتريات</h3>
                <button id="close-cart-button" class="text-3xl font-bold hover:text-red-500">&times;</button>
            </div>
            <div id="cart-items-container" class="space-y-4 mb-6 max-h-64 overflow-y-auto">
                <!-- Cart items will be injected here -->
            </div>
            <div class="border-t border-gray-600 pt-4">
                <div class="flex justify-between items-center text-xl font-bold">
                    <span>الإجمالي:</span>
                    <span id="cart-total">0 ر.س</span>
                </div>
                <button id="checkout-button" class="w-full btn-primary font-bold py-3 px-8 rounded-lg text-lg mt-6">إتمام الشراء</button>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-gray-900 text-white">
        <div class="container mx-auto px-6 py-8">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="mb-6 md:mb-0">
                    <h2 class="text-2xl font-bold flex items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7 ml-2 text-amber-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                           <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
                        </svg>
                        <div>
                            <span class="text-amber-400">متجر</span> المعرفة
                            <span class="block text-xs font-normal text-gray-400">للمنتجات الرقمية</span>
                        </div>
                    </h2>
                    <p class="text-gray-400 mt-2">أدواتك للإلهام والنمو.</p>
                </div>
                <div class="flex space-x-4 space-x-reverse">
                    <a href="#" class="text-gray-400 hover:text-white"><svg class="h-7 w-7" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M22 12c0-5.523-4.477-10-10-10S2 6.477 2 12c0 4.991 3.657 9.128 8.438 9.878v-6.987h-2.54V12h2.54V9.797c0-2.506 1.492-3.89 3.777-3.89 1.094 0 2.238.195 2.238.195v2.46h-1.26c-1.243 0-1.63.771-1.63 1.562V12h2.773l-.443 2.89h-2.33v6.988C18.343 21.128 22 16.991 22 12z" clip-rule="evenodd" /></svg></a>
                    <a href="#" class="text-gray-400 hover:text-white"><svg class="h-7 w-7" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.29 20.251c7.547 0 11.675-6.253 11.675-11.675 0-.178 0-.355-.012-.53A8.348 8.348 0 0022 5.92a8.19 8.19 0 01-2.357.646 4.118 4.118 0 001.804-2.27 8.224 8.224 0 01-2.605.996 4.107 4.107 0 00-6.993 3.743 11.65 11.65 0 01-8.457-4.287 4.106 4.106 0 001.27 5.477A4.072 4.072 0 012.8 9.71v.052a4.105 4.105 0 003.292 4.022 4.095 4.095 0 01-1.853.07 4.108 4.108 0 003.834 2.85A8.233 8.233 0 012 18.407a11.616 11.616 0 006.29 1.84" /></svg></a>
                    <a href="#" class="text-gray-400 hover:text-white"><svg class="h-7 w-7" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M12.315 2c2.43 0 2.784.013 3.808.06 1.064.049 1.791.218 2.427.465a4.902 4.902 0 011.772 1.153 4.902 4.902 0 011.153 1.772c.247.636.416 1.363.465 2.427.048 1.024.06 1.378.06 3.808s-.012 2.784-.06 3.808c-.049 1.064-.218 1.791-.465 2.427a4.902 4.902 0 01-1.153 1.772 4.902 4.902 0 01-1.772 1.153c-.636.247-1.363.416-2.427.465-1.024.048-1.378.06-3.808.06s-2.784-.013-3.808-.06c-1.064-.049-1.791-.218-2.427-.465a4.902 4.902 0 01-1.772-1.153 4.902 4.902 0 01-1.153-1.772c-.247-.636-.416-1.363-.465-2.427-.048-1.024-.06-1.378-.06-3.808s.012-2.784.06-3.808c.049-1.064.218-1.791.465-2.427a4.902 4.902 0 011.153-1.772A4.902 4.902 0 016.345 2.525c.636-.247 1.363.416 2.427.465C9.792 2.013 10.146 2 12.315 2zm-1.161 1.043c-1.022.048-1.637.21-2.148.41a3.896 3.896 0 00-1.398.922 3.896 3.896 0 00-.922 1.398c-.2.511-.362 1.126-.41 2.148-.046 1.024-.06 1.348-.06 3.731s.014 2.707.06 3.731c.048 1.022.21 1.637.41 2.148.21.533.504 1.012.922 1.398.418.389.865.683 1.398.922.511.2.97.362 2.148.41 1.024.046 1.348.06 3.731.06s2.707-.014 3.731-.06c1.022-.048 1.637-.21 2.148-.41.533-.21.98-.504 1.398-.922.389-.418.683-.865.922-1.398.2-.511.362-1.126.41-2.148.046-1.024.06-1.348-.06-3.731s-.014-2.707-.06-3.731c-.048-1.022-.21-1.637-.41-2.148a3.896 3.896 0 00-.922-1.398 3.896 3.896 0 00-1.398-.922c-.511-.2-.97-.362-2.148-.41-1.024-.046-1.348-.06-3.731-.06s-2.707.014-3.731.06zM12 8.118c-2.147 0-3.882 1.735-3.882 3.882s1.735 3.882 3.882 3.882 3.882-1.735 3.882-3.882-1.735-3.882-3.882-3.882zm0 6.726c-1.573 0-2.844-1.271-2.844-2.844s1.271-2.844 2.844-2.844 2.844 1.271 2.844 2.844-1.271 2.844-2.844 2.844zM16.802 8.249a1.232 1.232 0 110-2.464 1.232 1.232 0 010 2.464z" clip-rule="evenodd" /></svg></a>
                </div>
            </div>
            <div class="mt-8 border-t border-gray-700 pt-6 text-center text-gray-500">
                <p>&copy; 2025 متجر المعرفة للمنتجات الرقمية. كل الحقوق محفوظة.</p>
            </div>
        </div>
    </footer>

    <!-- Swiper's JS -->
    <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getFirestore, collection, onSnapshot, setLogLevel } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";

        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {};
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);
        setLogLevel('debug');
        
        const productsGrid = document.getElementById('products-grid');
        const cartButton = document.getElementById('cart-button');
        const cartModal = document.getElementById('cart-modal');
        const closeCartButton = document.getElementById('close-cart-button');
        const cartItemsContainer = document.getElementById('cart-items-container');
        const cartTotalEl = document.getElementById('cart-total');
        const cartCounter = document.getElementById('cart-counter');
        const checkoutButton = document.getElementById('checkout-button');
        const checkoutSummary = document.getElementById('checkout-summary');
        const checkoutSubtotal = document.getElementById('checkout-subtotal');
        const checkoutTotal = document.getElementById('checkout-total');

        let cart = JSON.parse(localStorage.getItem('knowledgeStoreCart')) || [];

        function showPage(pageId, element) {
            document.querySelectorAll('.page-content').forEach(page => page.style.display = 'none');
            document.getElementById(pageId).style.display = 'block';
            document.querySelectorAll('.nav-link').forEach(link => link.classList.remove('active'));
            if (element) element.classList.add('active');
        }

        function updateCartUI() {
            cartItemsContainer.innerHTML = '';
            let total = 0;
            if (cart.length === 0) {
                cartItemsContainer.innerHTML = '<p class="text-center text-gray-400">سلتك فارغة.</p>';
            } else {
                cart.forEach(item => {
                    total += item.price * item.quantity;
                    const itemElement = document.createElement('div');
                    itemElement.className = 'cart-item flex justify-between items-center py-2 border-b border-gray-700';
                    itemElement.innerHTML = `
                        <div class="flex items-center">
                            <img src="${item.image}" alt="${item.name}">
                            <div class="mr-4">
                                <h4 class="font-bold">${item.name}</h4>
                                <p class="text-sm text-gray-400">${item.price} ر.س</p>
                            </div>
                        </div>
                        <div class="flex items-center">
                            <span class="ml-4">x ${item.quantity}</span>
                            <button class="text-red-500 hover:text-red-700 text-2xl remove-from-cart" data-id="${item.id}">&times;</button>
                        </div>
                    `;
                    cartItemsContainer.appendChild(itemElement);
                });
            }
            cartTotalEl.textContent = `${total.toFixed(2)} ر.س`;
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            cartCounter.textContent = totalItems;
            cartCounter.style.display = totalItems > 0 ? 'flex' : 'none';
        }
        
        function updateCheckoutUI() {
            checkoutSummary.innerHTML = '';
            let subtotal = 0;
             if (cart.length === 0) {
                checkoutSummary.innerHTML = '<p class="text-center text-gray-400">لا توجد منتجات في السلة لإتمام الشراء.</p>';
            } else {
                cart.forEach(item => {
                    subtotal += item.price * item.quantity;
                    const summaryItem = document.createElement('div');
                    summaryItem.className = 'flex justify-between text-gray-300';
                    summaryItem.innerHTML = `
                        <span>${item.name} (x${item.quantity})</span>
                        <span>${(item.price * item.quantity).toFixed(2)} ر.س</span>
                    `;
                    checkoutSummary.appendChild(summaryItem);
                });
            }
            checkoutSubtotal.textContent = `${subtotal.toFixed(2)} ر.س`;
            checkoutTotal.textContent = `${subtotal.toFixed(2)} ر.س`;
        }

        function addToCart(product) {
            const existingItem = cart.find(item => item.id === product.id);
            if (existingItem) {
                existingItem.quantity++;
            } else {
                cart.push({ ...product, quantity: 1 });
            }
            localStorage.setItem('knowledgeStoreCart', JSON.stringify(cart));
            updateCartUI();
        }

        function removeFromCart(productId) {
            cart = cart.filter(item => item.id !== productId);
            localStorage.setItem('knowledgeStoreCart', JSON.stringify(cart));
            updateCartUI();
        }

        async function renderStoreProducts() {
            const productsCollectionPath = `/artifacts/${appId}/public/data/products`;
            const productsCollection = collection(db, productsCollectionPath);
            onSnapshot(productsCollection, (querySnapshot) => {
                productsGrid.innerHTML = '';
                if (querySnapshot.empty) {
                    productsGrid.innerHTML = '<p class="col-span-full text-center text-lg">لا توجد منتجات لعرضها حالياً.</p>';
                    return;
                }
                querySnapshot.forEach((doc) => {
                    const product = { id: doc.id, ...doc.data() };
                    const productCard = document.createElement('div');
                    productCard.className = 'card rounded-lg overflow-hidden shadow-lg flex flex-col';
                    productCard.innerHTML = `
                        <img src="${product.image}" alt="${product.name}" class="w-full h-64 object-cover" onerror="this.onerror=null;this.src='https://placehold.co/600x400/1a2942/fbbf24?text=Image+Not+Found';">
                        <div class="p-6 flex flex-col flex-grow">
                            <h4 class="text-2xl font-bold mb-2 flex-grow">${product.name}</h4>
                            <p class="mb-4 text-gray-400">${product.description}</p>
                            <div class="flex justify-between items-center mt-auto">
                                <span class="text-2xl font-bold text-amber-400">${product.price} ر.س</span>
                                <button class="btn-secondary font-bold py-2 px-4 rounded-lg add-to-cart-btn">أضف للسلة</button>
                            </div>
                        </div>
                    `;
                    productCard.querySelector('.add-to-cart-btn').addEventListener('click', () => addToCart(product));
                    productsGrid.appendChild(productCard);
                });
            });
        }

        document.addEventListener('DOMContentLoaded', () => {
            const homeLink = document.querySelector('a[onclick*=\'home\']');
            showPage('home', homeLink);

            const swiper = new Swiper('.swiper-container', {
                loop: true,
                autoplay: { delay: 3000, disableOnInteraction: false },
                effect: 'fade',
                fadeEffect: { crossFade: true },
            });

            onAuthStateChanged(auth, (user) => {
                if (user) { renderStoreProducts(); }
            });

            async function _initAuth() {
                try {
                    if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
                        await signInWithCustomToken(auth, __initial_auth_token);
                    } else {
                        await signInAnonymously(auth);
                    }
                } catch (error) {
                    console.error("Storefront auth failed:", error);
                    productsGrid.innerHTML = '<p class="col-span-full text-center text-lg text-red-500">فشل الاتصال بالخادم لعرض المنتجات.</p>';
                }
            }
            
            cartButton.addEventListener('click', () => cartModal.style.display = 'block');
            closeCartButton.addEventListener('click', () => cartModal.style.display = 'none');
            window.addEventListener('click', (event) => {
                if (event.target == cartModal) {
                    cartModal.style.display = 'none';
                }
            });
            cartItemsContainer.addEventListener('click', (e) => {
                if (e.target.classList.contains('remove-from-cart')) {
                    removeFromCart(e.target.dataset.id);
                }
            });
            checkoutButton.addEventListener('click', () => {
                if (cart.length > 0) {
                    cartModal.style.display = 'none';
                    updateCheckoutUI();
                    showPage('checkout');
                } else {
                    alert("سلتك فارغة!");
                }
            });

            updateCartUI();
            _initAuth();
        });
        
        window.showPage = showPage;
    </script>

</body>
</html>


